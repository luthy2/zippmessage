<!--extends base layout -->
{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-md-5 col-md-offset-3">
    <div class = "alert alert-info"	role= "alert">
      Welcome to Zipp! <a href = "{{url_for('welcome')}}" class = "alert-link">How it works</a>
    </div>
  </div>
</div>
<div class = "row text-align text-center">
  <div class = "col-md-5 col-md-offset-3 col-xs-10 col-xs-offset-1">
    <a href ="#compose" class ="btn btn-link btn-default btn-block"><span class = "glyphicon glyphicon-edit"></span></a>
  </div>
</div>
<div class = "row" id="compose">
  <div class="col-md-5 col-md-offset-3 col-sm-8" style="padding-bottom:10px;">
    <h4>Share a link</h4>
      <form action="" method = "POST" class="">
        <div class="form-group">
          {{form.hidden_tag()}}
            {{form.message_url(class_="form-control", placeholder="paste a URL")}}
        </div>
        <div class = "form-group">
            {{form.message_title(class_="form-control", placeholder="Add a note")}}
        </div>
          <input id="outline" type = "submit" value = "Next" class = "btn btn-default pull-right">
      </form>
  </div>
</div>
<div class="row">
  <div class ="col-sm-3 hidden-xs">
    <ul class = "list-group">
      <li class="list-group-item">
      <a href ="{{url_for('tags')}}"><h4>Tags</h4></a>
      <hr>
      {% if user_tags %}
        {% for tag in user_tags%}
          <p><a href = "{{url_for('tag', name = tag[0])}}">#{{tag[0]}} </a><small>{{tag[1]}}</small></p>
        {% endfor %}
      </li>
        <a class="list-group-item" href = "{{url_for('tags')}}">see all tags <span class = "glyphicon glyphicon-chevron-right pull-right"></span></a>
      {% else %}
        <p>no tagged items yet :/</p>
      {% endif %}
    </ul>
  </div>
  <div class="col-xs-12 hidden-sm hidden-md hidden-lg">
    <ul class = "list-group">
      {% if user_tags %}
        <a class="list-group-item" href = "{{url_for('tags')}}">see all tags <span class = "glyphicon glyphicon-chevron-right pull-right"></span></a>
      {% else %}
        <p>no tagged items yet :/</p>
      {% endif %}
    </ul>
  </div>
	<div class ="col-md-5 col-sm-8"  ng-controller="InboxController" ng-cloak>
    {% raw %}
    <div class = "alert alert-info"	role= "alert" ng-show="alert">
      {{alert}}
    </div>
    <ul class = "list-group" ng-repeat="message in inbox">
      <li class = "list-group-item">
        <p><a href = "/user/{{message.from_user}}">@{{message.from_user}}:</a> {{message.note}}<span class ='pull-right' style="color:gray">{{message.timedelta}}</span></p>
        <span class = "embedly-embed" ng-bind-html="$sce.trustAsHtml(message.content)"></span>
      </li>
      <li class = "list-group-item" style="text-align:center;">
        <button type="button" class="btn btn-link btn-sm" style="width:14%" ng-click="dismissMessage(message.id)" ><span id="dismiss" class="glyphicon glyphicon-remove"></span></button>
        <a type="button" class="btn btn-link btn-sm" style="width:14%" href ="/bookmark/{{message.id}}?next=inbox"><span class="glyphicon glyphicon-bookmark green-hover" aria-hidden="true"></span></a>
        <a type="button" class="btn btn-link btn-sm" style="width:14%" href = "/message/reader/{{message.id}}"><span class="glyphicon glyphicon-book green-hover" aria-hidden="true"></span></a>
        <a type="button" class="btn btn-link btn-sm" style="width:14%" href ="/share/{{message.id}}?next=inbox"><span class="glyphicon glyphicon-send blue-hover" aria-hidden="true"></span></a>
      </li>
    </ul>
    <div class="loader" ng-show="loading">Loading...</div>
    <div class = "text-center" style="padding-bottom:50px" ng-cloak>
      <button type = "button" class = "btn btn-default btn-block" id="outline" ng-click="getInbox()" ng-hide="loadedAll">Load Next 6</button>
      <span ng-show="loadedAll"><h3>You've reached the end of your inbox! :)</h3></span>
    </div>
    {% endraw %}
    <script type="text/javascript" src="/static/js/app.js"></script>
  </div>
  <div class = "col-md-3 hidden-sm hidden-xs">
    <ul class = "list-group">
      <li class="list-group-item">
        <a href=# ><h4 class="text-right">Activity</h4></a>
        <hr>
      {% if activity_feed %}
        {% for item in activity_feed %}
          <a class = "list-group-item" href = "{{url_for(reader, message = message_id)}}">{{item.subject.username}} {{item.action}} your message: {{item.message.note}}</a>
        {% endfor %}
      {% else %}
          <p>Coming Soon. Make sure you <a href = "{{url_for('find_contacts')}}">add your friends!</a></p>
      {% endif %}
      </li>
      <li class="list-group-item">See all activity<span class="glyphicon glyphicon-chevron-right pull-right"></span></li>
    </ul>
  </div>
</div>
<script type="text/javascript">
	$(".inbox").addClass("active")
</script>
{% endblock %}
