<!--extends base layout -->

{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-md-6 col-md-offset-3">
    <div class = "alert alert-info"	role= "alert">
      Welcome to Zipp! <a href = "{{url_for('welcome')}}" class = "alert-link">How it works</a>
    </div>
  </div>
</div>
<div class = "row">
  <style>
    .hide:target {
      display:none;
    }
    .hide:target ~ .compose{
      display:inline;
    }
    .reveal{
      display:none;
    }
  </style>
  <div class="col-md-6 col-md-offset-3">
    <span class = "glyphicon glyphicon-edit" id="reveal"></span>
  </div>
  <div class="col-md-6 col-md-offset-3" id="compose">
    <h4>New Message</h4>
      <form action="" method = "POST" name="new message">
        <div class="form-group">
          {{form.hidden_tag()}}
            <label>URL</label>
            {{form.message_url(class_="form-control")}}
        </div>
        <div class = "form-group">
            <label>Add a Note</label>
            {{form.message_title(class_="form-control")}}
        </div>
          <input type = "submit" value = "Next" class = "btn btn-default">
      </form>
  </div>
</div>
<div class="row">
  <div class ="col-md-3 hidden-xs hidden-sm">
    <ul class = "list-group">
      <a class="list-group-item" href ="{{url_for('tags')}}"><h4>tags</h4></a>
      {% if user_tags %}
        {% for tag in user_tags%}
          <a class ="list-group-item" href = "{{url_for('tag', name = tag[0])}}">#{{tag[0]}}<label class="badge">{{tag[1]}}</a>
        {% endfor %}
        <a class = "list-group-item" href = "{{url_for('tags')}}">see all tags <span class = "glyphicon glyphicon-chevron-right text-right"></span></a>
      {% else %}
        <li class = "list-group-item">no tagged items yet :/</li>
      {% endif %}
    </ul>
  </div>
  <div class ="col-sm-6 col-sm-offset-3 hidden-md hidden-lg">
    <ul class = "list-group">
      <a class="list-group-item" href ="{{url_for('tags')}}"><h4>see all tags<span class ="glyphicon glyphicon-chevron-right pull-right"></span></h4></a>
    </ul>
  </div>
	<div class ="col-md-6"  ng-controller="InboxController" ng-cloak>
    {% raw %}
    <div class = "alert alert-info"	role= "alert" ng-show="alert">
      {{alert}}
    </div>
    <ul class = "list-group" ng-repeat="message in inbox" >
      <li class = "list-group-item">
        <p><a href = "/user/{{message.from_user}}">@{{message.from_user}}:</a> {{message.note}}<span class ='pull-right' style="color:gray">{{message.timedelta}}</span></p>
        <span class = "embedly-embed" ng-bind-html="$sce.trustAsHtml(message.content)"></span>
      </li>
      <li class = "list-group-item" style="text-align:center;">
        <button type="button" class="btn btn-link btn-sm" style="width:17%" ng-click="dismissMessage(message.id)"><span class="glyphicon glyphicon-remove"></span></button>
        <a type="button" class="btn btn-link btn-sm" style="width:17%" href ="/bookmark/{{message.id}}?next=inbox"><span class="glyphicon glyphicon-bookmark" aria-hidden="true"></span></a>
        <a type="button" class="btn btn-link btn-sm" style="width:17%" href ="/share/{{message.id}}?next=inbox"><span class="glyphicon glyphicon-send" aria-hidden="true"></span></a>
      </li>
    </ul>
    <div class="loader" ng-show="loading">Loading...</div>
    <div class = "text-center" style="padding-bottom:20px" ng-cloak>
      <button type = "button" class = "btn btn-default btn-sm btn-block btn" ng-click="getInbox()" ng-hide="loadedAll">load more</button>
      <span ng-show="loadedAll"><h2>You've reached the end of your inbox! :)</h2></span>
    </div>
    {% endraw %}
    <script type="text/javascript" src="/static/js/app.js"></script>
  </div>
</div>

{% endblock %}
